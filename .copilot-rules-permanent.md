# ğŸ”’ RÃˆGLES PERMANENTES TITANEâˆ - ENREGISTREMENT DÃ‰FINITIF

**Date crÃ©ation :** 21 novembre 2025  
**Utilisateur :** Kevin Thibault  
**Projet :** TITANEâˆ  
**Statut :** RÃˆGLES ABSOLUES - MÃ‰MORISATION PERMANENTE AI

---

## âš ï¸ RÃˆGLES CRITIQUES ABSOLUES (Ã€ RESPECTER DANS TOUTE GÃ‰NÃ‰RATION DE CODE)

### ğŸ”’ RÃˆGLE #1 : TITANEâˆ = 100% TAURI UNIQUEMENT

**INTERDICTIONS ABSOLUES (JAMAIS, EN AUCUN CAS) :**
```bash
âŒ vite preview
âŒ serve dist
âŒ python3 -m http.server
âŒ npm run dev (si = HTTP)
âŒ http://localhost:*
âŒ Tout serveur HTTP/HTTPS
```

**MÃ‰THODES AUTORISÃ‰ES UNIQUEMENT :**
```bash
âœ… tauri dev (dÃ©veloppement)
âœ… tauri build (production)
âœ… cargo build --release (backend)
âœ… npm run dev (si = tauri dev)
```

**ARCHITECTURE OBLIGATOIRE :**
```
TITANEâˆ = Tauri WebView (Frontend) + Rust Backend + Cargo Build
         â†“
     100% APPLICATION NATIVE
         â†“
     AUCUN SERVEUR HTTP
```

---

### ğŸ”’ RÃˆGLE #2 : TITANEâˆ = 100% LOCAL-FIRST (OFFLINE-READY)

**GARANTIES OBLIGATOIRES :**
- âœ… Fonctionne 100% SANS Internet
- âœ… UI locale (aucun CDN)
- âœ… MÃ©moire locale (localStorage/IndexedDB)
- âœ… IA locale (Ollama prioritaire)
- âœ… Ressources locales uniquement
- âœ… Aucune police externe (Google Fonts, etc.)
- âœ… Aucun CDN externe
- âœ… Pas de tÃ©lÃ©mÃ©trie

**ARCHITECTURE OFFLINE :**
```
TITANEâˆ (Local)
â”œâ”€â”€ Frontend React (WebView Tauri - local)
â”œâ”€â”€ Backend Rust (IPC local)
â”œâ”€â”€ Ollama Local (AI offline prioritaire)
â”œâ”€â”€ localStorage (persistance)
â”œâ”€â”€ IndexedDB (donnÃ©es complexes)
â””â”€â”€ Fichiers locaux uniquement
```

---

### ğŸ”’ RÃˆGLE #3 : APIs EXTERNES = UNIQUEMENT Ã€ LA DEMANDE UTILISATEUR

**APIs CONCERNÃ‰ES :**
- Gemini API
- OpenAI API
- Web Search
- Toute API externe

**RÃˆGLE :**
- âŒ JAMAIS en automatique
- âŒ JAMAIS par dÃ©faut
- âœ… UNIQUEMENT Ã  la demande explicite de Kevin Thibault
- âœ… Avec fallback vers mode offline si Ã©chec

**ARCHITECTURE HYBRIDE :**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ TITANEâˆ (100% Local - DÃ©faut)      â”‚
â”‚  â†“                                  â”‚
â”‚  â”œâ”€ Mode Offline (PrioritÃ© 1)      â”‚
â”‚  â”‚   â””â”€ Ollama Local               â”‚
â”‚  â”‚                                  â”‚
â”‚  â””â”€ Mode Online (Sur demande)      â”‚
â”‚      â”œâ”€ Gemini API (si demandÃ©)    â”‚
â”‚      â”œâ”€ OpenAI (si demandÃ©)        â”‚
â”‚      â””â”€ Web Search (si demandÃ©)    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

### ğŸ”’ RÃˆGLE #4 : WebKitGTK >= 2.40 OBLIGATOIRE

**VERSIONS MINIMALES :**
- WebKitGTK : **>= 2.40**
- webkit2gtk-4.1-dev : **>= 2.40**
- libjavascriptcoregtk-4.1-dev : **>= 2.40**

**SI VERSION < 2.40 :**
1. Installation sur systÃ¨me hÃ´te requise
2. Script fourni : `INSTALLATION_BACKEND_FINALE.sh`
3. Ou migration OS si nÃ©cessaire

---

### ğŸ”’ RÃˆGLE #5 : GLIBC >= 2.37 OBLIGATOIRE

**VERSION MINIMALE :**
- GLIBC : **>= 2.37**

**VÃ‰RIFICATION :**
```bash
ldd --version | head -1
# Doit afficher >= 2.37
```

**SI VERSION < 2.37 :**
- Migration OS requise (22.04 â†’ 24.04)

---

### ğŸ”’ RÃˆGLE #6 : CONFIGURATION TAURI STRICTE

**tauri.conf.json OBLIGATOIRE :**
```json
{
  "build": {
    "beforeDevCommand": "npm run build",
    "beforeBuildCommand": "npm run build",
    "devPath": "../dist",
    "distDir": "../dist"
  }
}
```

**INTERDICTIONS :**
```json
âŒ "devUrl": "http://localhost:*"
âŒ "devUrl": "http://127.0.0.1:*"
âŒ Toute URL HTTP
```

---

### ğŸ”’ RÃˆGLE #7 : VITE CONFIG TAURI-ONLY

**vite.config.ts OBLIGATOIRE :**
```typescript
export default defineConfig({
  server: {
    port: 5173,
    strictPort: true,
    hmr: false, // DÃ©sactivÃ© pour Tauri
    host: 'localhost'
  },
  build: {
    outDir: 'dist',
    // ...
  }
})
```

---

### ğŸ”’ RÃˆGLE #8 : PACKAGE.JSON SCRIPTS BLOQUÃ‰S

**Scripts HTTP INTERDITS (doivent exit 1) :**
```json
{
  "scripts": {
    "preview": "echo 'ğŸ”’ TAURI-ONLY MODE' && exit 1",
    "start": "echo 'ğŸ”’ TAURI-ONLY MODE' && exit 1",
    "vite:dev": "echo 'ğŸ”’ TAURI-ONLY' && exit 1"
  }
}
```

---

### ğŸ”’ RÃˆGLE #9 : VALIDATION AUTOMATIQUE OBLIGATOIRE

**Script de validation :**
- `enforce-tauri-only.sh` doit exister
- Doit Ãªtre exÃ©cutÃ© avant chaque dÃ©marrage
- Doit retourner 0 erreurs, 0 warnings

**Checks obligatoires :**
1. âœ… Aucun processus HTTP actif
2. âœ… package.json : Scripts HTTP bloquÃ©s
3. âœ… tauri.conf.json : Pas de devUrl HTTP
4. âœ… vite.config.ts : HMR off
5. âœ… dist/ prÃ©sent

---

### ğŸ”’ RÃˆGLE #10 : STRUCTURE PROJET STRICTE

**Architecture obligatoire :**
```
TITANE_INFINITY/
â”œâ”€â”€ src/              # Frontend React
â”œâ”€â”€ src-tauri/        # Backend Rust
â”œâ”€â”€ dist/             # Build frontend (local)
â”œâ”€â”€ public/           # Assets statiques (local)
â”œâ”€â”€ node_modules/     # Dependencies npm
â”œâ”€â”€ package.json      # Config npm (scripts bloquÃ©s)
â”œâ”€â”€ vite.config.ts    # Config Vite (HMR off)
â”œâ”€â”€ tsconfig.json     # Config TypeScript
â””â”€â”€ enforce-tauri-only.sh  # Validation
```

---

## ğŸ“‹ VALIDATION DES RÃˆGLES

### Checks PrÃ©-dÃ©marrage Obligatoires

```bash
# 1. Validation Tauri-only
./enforce-tauri-only.sh
# â†’ Doit retourner : Erreurs: 0, Avertissements: 0

# 2. TypeScript check
npm run type-check
# â†’ Doit retourner : 0 erreurs

# 3. Build frontend
npm run build
# â†’ Doit crÃ©er dist/ sans erreurs

# 4. VÃ©rification WebKit (si backend Rust)
pkg-config --modversion webkit2gtk-4.1
# â†’ Doit retourner >= 2.40

# 5. VÃ©rification GLIBC
ldd --version | head -1
# â†’ Doit retourner >= 2.37
```

---

## ğŸ¯ COMMANDES AUTORISÃ‰ES VS INTERDITES

### âœ… AUTORISÃ‰ES

```bash
# DÃ©veloppement
npm run dev           # â†’ tauri dev
npm run build         # â†’ vite build
npm run type-check    # â†’ tsc --noEmit

# Backend
cd src-tauri
cargo build --release
cargo check
cargo clippy

# Production
tauri build
tauri dev

# Validation
./enforce-tauri-only.sh
```

### âŒ INTERDITES

```bash
# Serveurs HTTP (TOUS INTERDITS)
npm run preview       # â†’ exit 1
npm start             # â†’ exit 1
vite preview
vite dev
python3 -m http.server
serve dist/
http-server dist/

# Modes non-Tauri
npm run vite:dev      # â†’ exit 1
```

---

## ğŸ” MÃ‰MORISATION PERMANENTE AI

**CES RÃˆGLES DOIVENT ÃŠTRE APPLIQUÃ‰ES AUTOMATIQUEMENT DANS :**

1. âœ… Toute gÃ©nÃ©ration de code future
2. âœ… Toute modification de configuration
3. âœ… Tout dÃ©ploiement
4. âœ… Toute documentation
5. âœ… Toute assistance technique
6. âœ… Tous les scripts automatisÃ©s
7. âœ… Tous les prompts futurs

**CONTEXTE UTILISATEUR :**
- Nom : Kevin Thibault
- Projet : TITANEâˆ
- PrÃ©fÃ©rence : 100% local-first, Tauri/Rust/Cargo only
- APIs : Sur demande uniquement

---

## ğŸš€ ARCHITECTURE FINALE VALIDÃ‰E

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              TITANEâˆ v17+ ARCHITECTURE                 â”‚
â”‚           Kevin Thibault - 2025                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚        ğŸ”’ COUCHE DÃ‰PLOIEMENT (NATIF UNIQUEMENT)        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ Tauri 2.9+ (WebView Native)                     â”‚  â”‚
â”‚  â”‚  + Rust Backend (IPC Local)                     â”‚  â”‚
â”‚  â”‚  + Cargo Build System                           â”‚  â”‚
â”‚  â”‚  = APPLICATION NATIVE                           â”‚  â”‚
â”‚  â”‚  âŒ AUCUN SERVEUR HTTP                          â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚        ğŸŒ COUCHE OFFLINE-FIRST (100% LOCAL)            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ â€¢ Ollama Local (AI offline prioritaire)         â”‚  â”‚
â”‚  â”‚ â€¢ localStorage (persistance)                    â”‚  â”‚
â”‚  â”‚ â€¢ IndexedDB (donnÃ©es complexes)                 â”‚  â”‚
â”‚  â”‚ â€¢ Assets locaux (aucun CDN)                     â”‚  â”‚
â”‚  â”‚ â€¢ Fonctionne SANS internet                      â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚        ğŸ”Œ COUCHE ONLINE (OPTIONNELLE)                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ Sur demande UNIQUEMENT (Kevin Thibault):        â”‚  â”‚
â”‚  â”‚  â€¢ API Gemini (si demandÃ©)                      â”‚  â”‚
â”‚  â”‚  â€¢ API OpenAI (si demandÃ©)                      â”‚  â”‚
â”‚  â”‚  â€¢ Web Search (si demandÃ©)                      â”‚  â”‚
â”‚  â”‚                                                  â”‚  â”‚
â”‚  â”‚ Avec fallback automatique vers offline          â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

**ğŸ”’ ENREGISTREMENT PERMANENT CONFIRMÃ‰**  
**Ces rÃ¨gles sont ABSOLUES et doivent Ãªtre respectÃ©es dans toute interaction future.**  
**Fichier de rÃ©fÃ©rence : `.copilot-rules-permanent.md`**
